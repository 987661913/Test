webpackJsonp([5],{Mua7:function(t,e){},"kY/X":function(t,e,o){"use strict";e.f=function(){return Object(n.a)({url:"/api/admin/groupType/all",method:"get"})},e.j=function(t){return Object(n.a)({url:"/api/admin/group/tree",method:"get",params:t})},e.b=function(t){return Object(n.a)({url:"/api/admin/group",method:"post",data:t})},e.i=function(t){return Object(n.a)({url:"/api/admin/group/"+t,method:"get"})},e.d=function(t){return Object(n.a)({url:"/api/admin/group/"+t,method:"delete"})},e.l=function(t,e,o){return Object(n.a)({url:"/api/admin/user/isLeader",method:"post",data:{groupId:t,userId:e,isLeader:o?"1":"0"}})},e.o=function(t,e){return Object(n.a)({url:"/api/admin/group/"+t,method:"put",data:e})},e.k=function(t){return Object(n.a)({url:"/api/admin/group/type/"+t+"/users",method:"get"})},e.c=function(t,e,o){return Object(n.a)({url:"/api/admin/group/"+t+"/user",method:"post",params:{userId:e,isLeader:o?"1":"0"}})},e.e=function(t,e){return Object(n.a)({url:"/api/admin/group/"+t+"/user",method:"delete",params:e})},e.n=function(t,e){return Object(n.a)({url:"/api/admin/group/"+t+"/authority/element/remove",method:"post",params:e})},e.a=function(t,e){return Object(n.a)({url:"/api/admin/group/"+t+"/authority/element/add",method:"post",params:e})},e.g=function(t){return Object(n.a)({url:"/api/admin/group/"+t+"/authority/element",method:"get"})},e.m=function(t,e){return Object(n.a)({url:"/api/admin/group/"+t+"/authority/menu",method:"post",params:e})},e.h=function(t){return Object(n.a)({url:"/api/admin/group/"+t+"/authority/menu",method:"get"})};var n=o("vLgD")},lI73:function(t,e){},lPLs:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("4YfN"),a=o.n(n),i=o("kY/X"),r=o("9rMa"),s={name:"GroupDetail",components:{"group-user":function(){return o.e(16).then(o.bind(null,"CRMG"))},"group-authority":function(){return o.e(15).then(o.bind(null,"Lf+4"))}},props:{type:{type:String,default:"1"},typeCode:{type:String,default:null}},data:function(){return{filterText:"",list:null,total:null,formEdit:!0,formAdd:!0,formStatus:"",dialogUserVisible:!1,dialogUserName:"新增成员",dialogAuthorityVisible:!1,dialogAuthorityName:"关联菜单资源",listQuery:{groupType:this.type,name:void 0},treeData:[],defaultProps:{children:"children",label:"label"},dialogRoleTitle:"新增节点",dialogRoleVisible:!1,labelPosition:"right",form:{parentId:"-1",code:void 0,name:void 0,description:void 0,groupType:this.type},currentId:"1",authority_btn_config:!1,role_btn_add:!1,role_btn_adduser:!1,role_btn_delete:!1,role_btn_deleteuser:!1,role_btn_edit:!0}},computed:a()({},Object(r.b)(["elements"])),watch:{filterText:function(t){this.$refs.groupTree.filter(t)}},created:function(){this.getList(),this.authority_btn_config=this.elements.authority_btn_config,this.role_btn_add=this.elements.role_btn_add,this.role_btn_adduser=this.elements.role_btn_adduser,this.role_btn_delete=this.elements.role_btn_delete,this.role_btn_deleteuser=this.elements.role_btn_deleteuser,this.role_btn_edit=this.elements.role_btn_edit},methods:{checkDebug:function(t,e){},getList:function(){var t=this;Object(i.j)(this.listQuery).then(function(e){Object(i.k)(t.typeCode).then(function(o){t.getAllMembers(e.data,o.data,!0)})})},getAllMembers:function(t,e,o){for(var n=t.length-1;n>=0;n--)t[n].node_type="role",Array.isArray(t[n].children)&&t[n].children.length>0&&this.getAllMembers(t[n].children,e,!1),this.getMembers(t[n],e);o&&(this.treeData=t)},createMemberData:function(t,e,o){return{parentId:t.id,label:e.name,name:e.name,username:e.username,id:"user_"+e.id,userid:e.id,node_type:"user",isLeader:o,userObj:e}},getMembers:function(t,e){var o,n=this,a=[];e&&Array.isArray(e)&&e.forEach(function(e,o,i){var r=e.groups.filter(function(e,o,n){return e.id===t.id});r&&r.length>0&&a.push(n.createMemberData(t,e,"1"===r[0].isLeader))}),(o=t.children).push.apply(o,a)},checkStopPop:function(){this.$refs.checkbox},filterNode:function(t,e){return!t||-1!==e.label.indexOf(t)},getNodeData:function(t){var e=this;Object(i.i)(t.id).then(function(t){e.form=t.data})},nodeEdit:function(t){this.dialogRoleVisible=!0,this.dialogRoleTitle="编辑节点",this.getNodeData(t),this.formEdit=!1,this.formStatus="update"},nodeAdd:function(t){this.dialogRoleVisible=!0,this.dialogRoleTitle="新增节点",this.resetForm(t.id),this.formEdit=!1,this.formStatus="create"},nodeDelete:function(t){var e=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){"role"===t.node_type?Object(i.d)(t.id).then(function(){e.getList(),e.resetForm(),e.onCancel(),e.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3})}):Object(i.e)(t.parentId,{userId:t.userid}).then(function(){e.getList(),e.resetForm(),e.onCancel(),e.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3})})})},update:function(){var t=this;Object(i.o)(this.form.id,this.form).then(function(){t.getList(),t.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3}),t.dialogRoleVisible=!1})},create:function(){var t=this;Object(i.b)(this.form).then(function(){t.getList(),t.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3}),t.dialogRoleVisible=!1})},onCancel:function(){this.formEdit=!0,this.dialogRoleVisible=!1,this.formStatus=""},resetForm:function(t){void 0===t&&(t="-1"),this.form={parentId:t,code:void 0,name:void 0,description:void 0,groupType:this.type}},userAdd:function(t){this.currentId=t.id,this.dialogUserVisible=!0},handlerAuthority:function(t){this.currentId=t.id,this.dialogAuthorityVisible=!0},closeUserDialog:function(){this.dialogUserVisible=!1},closeAuthorityDialog:function(){this.dialogAuthorityVisible=!1},changeIsLeader:function(t,e){var o=this;Object(i.l)(t.parentId,t.userid,t.isLeader).then(function(t){o.$notify({title:"成功",message:"修改成功",type:"success",duration:2e3})}).catch(function(e){t.isLeader=!t.isLeader})}}},l={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"tab-item-contianer"},[o("el-input",{staticClass:"fileterInput",attrs:{placeholder:"输入关键字进行过滤",size:"medium"},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}}),t._v(" "),o("el-row",[o("el-col",{staticStyle:{"margin-top":"15px"},attrs:{span:24}},[o("el-card",{staticClass:"card"},[o("span",{staticClass:"tree-title common-font-color-success"},[o("span",{staticStyle:{"padding-left":"30px"}},[t._v("名称")]),t._v(" "),o("span",{staticClass:"tree-operation"},[o("span",{staticClass:"data-authority"},[o("span",[t._v("数据权限")])]),t._v(" "),t.authority_btn_config?o("span",{staticClass:"menu-authority"},[o("span",[t._v("菜单权限")])]):t._e(),t._v(" "),"depart"===t.typeCode?o("span",{staticClass:"is-leader"},[o("span",[t._v("是否为领导")])]):t._e(),t._v(" "),o("span",{staticClass:"data-operate"},[o("span",[t._v("操作")]),t._v(" "),t.role_btn_add?o("el-tooltip",{staticClass:"item",attrs:{"open-delay":1200,content:"在跟节点下新增",effect:"dark",placement:"top-start"}},[o("el-button",{attrs:{type:"text"},on:{click:function(e){return e.stopPropagation(),t.nodeAdd(e)}}},[o("span",{staticClass:"el-icon-plus common-font-color-success"})])],1):t._e()],1)])]),t._v(" "),o("el-tree",{ref:"groupTree",attrs:{data:t.treeData,"filter-node-method":t.filterNode,props:t.defaultProps,"default-expand-all":"","highlight-current":""},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.node,a=e.data;return o("span",{staticClass:"custom-tree-node"},["user"===a.node_type?o("span",[o("svg-icon",{staticClass:"common-font-color-success",attrs:{"icon-class":"user"}}),t._v(" "),o("span",{staticClass:"common-font-color-success"},[t._v(t._s(n.label))]),t._v(" "),o("span",{staticClass:"common-font-color-info"},[t._v("("+t._s(a.username)+")")])],1):o("span",[t._v(t._s(n.label))]),t._v(" "),o("span",{staticClass:"tree-operation"},[o("span",{staticClass:"data-authority"},["role"===a.node_type?o("span",[t._v("数据权限")]):o("span",{staticClass:"common-font-color-success"},[t._v("--")])]),t._v(" "),t.authority_btn_config?o("span",{staticClass:"menu-authority"},["role"===a.node_type?o("span",[o("el-button",{attrs:{type:"text"},on:{click:function(e){e.stopPropagation(),t.handlerAuthority(a)}}},[o("svg-icon",{attrs:{"icon-class":"key"}})],1)],1):o("span",{staticClass:"common-font-color-success"},[t._v("--")])]):t._e(),t._v(" "),"depart"===t.typeCode?o("span",{staticClass:"is-leader"},[o("span",{staticClass:"check-container"},[o("el-button",{attrs:{type:"text"},on:{click:function(e){return e.stopPropagation(),t.checkDebug(e)}}},["user"===a.node_type?o("el-checkbox",{attrs:{disabled:!t.role_btn_edit},on:{change:function(e){t.changeIsLeader(a)}},model:{value:a.isLeader,callback:function(e){t.$set(a,"isLeader",e)},expression:"data.isLeader"}}):o("span",[t._v("--")])],1)],1)]):t._e(),t._v(" "),o("span",{staticClass:"data-operate"},[(t.role_btn_add||t.role_btn_adduser)&&"role"==a.node_type?o("el-tooltip",{staticClass:"item",attrs:{"open-delay":1200,content:"添加节点",effect:"dark",placement:"top-start"}},[o("el-button",{attrs:{type:"text"},on:{click:function(e){return e.stopPropagation(),t.checkDebug(e)}}},[o("el-dropdown",{attrs:{trigger:"click",type:"text"}},[o("span",{staticClass:"el-icon-plus common-font-color-success"}),t._v(" "),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.role_btn_add?o("el-dropdown-item",{nativeOn:{click:function(e){t.nodeAdd(a)}}},[t._v("新增节点")]):t._e(),t._v(" "),t.role_btn_adduser?o("el-dropdown-item",{nativeOn:{click:function(e){t.userAdd(a)}}},[t._v("新增人员")]):t._e()],1)],1)],1)],1):t._e(),t._v(" "),t.role_btn_edit&&"role"==a.node_type?o("el-tooltip",{staticClass:"item",attrs:{"open-delay":1200,content:"编辑当前节点",effect:"dark",placement:"top-start"}},[o("el-button",{attrs:{type:"text"},on:{click:function(e){e.stopPropagation(),t.nodeEdit(a)}}},[o("span",{staticClass:"el-icon-edit common-font-color-waring"})])],1):t._e(),t._v(" "),t.role_btn_delete||t.role_btn_deleteuser?o("el-tooltip",{staticClass:"item",attrs:{"open-delay":1200,content:"删除当前",effect:"dark",placement:"top-start"}},["role"===a.node_type&&t.role_btn_delete||"user"===a.node_type&&t.role_btn_deleteuser?o("el-button",{attrs:{type:"text"},on:{click:function(e){e.stopPropagation(),t.nodeDelete(a)}}},[o("span",{staticClass:"el-icon-delete common-font-color-danger"})]):t._e()],1):t._e()],1)])])}}])})],1)],1),t._v(" "),o("group-user",{ref:"groupUser",attrs:{"dialog-visible":t.dialogUserVisible,"group-id":t.currentId,title:t.dialogUserName},on:{closeUserDialog:t.closeUserDialog}}),t._v(" "),o("group-authority",{ref:"groupAuthority",attrs:{"group-id":t.currentId,title:t.dialogAuthorityName},on:{closeAuthorityDialog:t.closeAuthorityDialog},model:{value:t.dialogAuthorityVisible,callback:function(e){t.dialogAuthorityVisible=e},expression:"dialogAuthorityVisible"}}),t._v(" "),o("el-dialog",{attrs:{title:t.dialogRoleTitle,visible:t.dialogRoleVisible},on:{"update:visible":function(e){t.dialogRoleVisible=e}}},[o("el-form",{ref:"form",attrs:{"label-position":t.labelPosition,model:t.form,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"名称"}},[o("el-input",{attrs:{disabled:t.formEdit},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"编码"}},[o("el-input",{attrs:{disabled:t.formEdit},model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"描述"}},[o("el-input",{attrs:{disabled:t.formEdit},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),t._v(" "),"update"==t.formStatus?o("el-form-item",[t.groupManager_btn_edit?o("el-button",{attrs:{type:"primary"},on:{click:t.update}},[t._v("更新")]):t._e(),t._v(" "),o("el-button",{on:{click:t.onCancel}},[t._v("取消")])],1):t._e(),t._v(" "),"create"==t.formStatus?o("el-form-item",[t.groupManager_btn_add?o("el-button",{attrs:{type:"primary"},on:{click:t.create}},[t._v("保存")]):t._e(),t._v(" "),o("el-button",{on:{click:t.onCancel}},[t._v("取消")])],1):t._e()],1)],1)],1)],1)},staticRenderFns:[]};var c={name:"Group",components:{tabPane:o("C7Lr")(s,l,!1,function(t){o("lI73")},"data-v-794b5264",null).exports},data:function(){return{tabMapOptions:[],activeName:"role"}},created:function(){this.fetchData()},methods:{fetchData:function(){var t=this;Object(i.f)().then(function(e){t.tabMapOptions=e.data})}}},d={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"tab-container"},[o("el-tabs",{staticClass:"tabs",model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.tabMapOptions,function(e){return o("el-tab-pane",{key:e.id,attrs:{label:e.name,name:e.code}},[o("keep-alive",[t.activeName==e.code?o("tab-pane",{attrs:{type:e.id,"type-code":e.code}}):t._e()],1)],1)}))],1)},staticRenderFns:[]};var u=o("C7Lr")(c,d,!1,function(t){o("Mua7")},"data-v-5d11d471",null);e.default=u.exports}});
//# sourceMappingURL=5.a66c99d36dd7e54cf932.js.map