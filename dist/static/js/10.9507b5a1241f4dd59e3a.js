webpackJsonp([10],{GjTr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("vLgD");function l(t,e,i,l,n){return Object(a.a)({method:"post",url:"/api/admin/directory",data:{icon:t,name:e,type:i,parentId:l,typeId:n}})}function n(t,e){return Object(a.a)({method:"get",url:"/api/admin/file/"+t+"/list?name="+e,data:{}})}var s={data:function(){return{fileListId:"",options:[{value:"1",label:"个人"},{value:"2",label:"项目"},{value:"3",label:"群组"}],categoryFileList:[],searchList:"",tagType:"",tagName:"",tagIcon:"",menuVisible:!1,dialogFormVisible:!1,textTitlt:"新增节点",fileList:[],allDirectoryList:[],rightPadding:0,defaultProps:{children:"children",label:"name"},rightClickMenuData:"",selectKey:""}},created:function(){this.getAllDirectory()},mounted:function(){this.rightPadding=.0416667*document.querySelector(".mainWrap").clientWidth,window.addEventListener("resize",function(t){document.querySelector(".mainWrap").clientWidth})},methods:{deleteList:function(t){var e=this;this.$confirm("此操作将永久删除该目录和其子目录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){(function(t){return Object(a.a)({method:"delete",url:"/api/admin/file/"+t,data:{}})})(t).then(function(){n(e.fileListId,"").then(function(t){e.categoryFileList=t.data}),e.$notify({title:"成功",message:"删除成功！",type:"success",duration:2e3})})})},searchData:function(){var t=this;n(this.fileListId,this.searchList).then(function(e){t.categoryFileList=e.data})},calculateFileSize:function(t){return t/1024<1e3?(t/1024).toFixed(2)+"kb":t/1024>1e3?(t/1024/1024).toFixed(2)+"MB":void 0},testClik:function(t,e,i,a){var l=this;this.fileListId=e.key,n(e.key,"").then(function(t){l.categoryFileList=t.data})},beforeUpload:function(t){var e,i,l=this,s=new FormData;s.append("file",t.file),(e=s,i=this.fileListId,Object(a.a)({method:"post",url:"/api/admin/file/upload?fileId="+i,data:e})).then(function(t){l.fileList=[],n(l.fileListId,"").then(function(t){l.categoryFileList=t.data}),200===t.status&&l.$notify({title:"成功",message:"上传成功！",type:"success",duration:2e3})})},handleRightSelect:function(t){this.selectKey=t,1===parseInt(t)||2===parseInt(t)?this.dialogFormVisible=!0:3===parseInt(t)?(this.dialogFormVisible=!0,this.queryTheCurrentNode()):4===parseInt(t)&&this.deleteTheCurrentNode(this.rightClickMenuData.id)},rihgtClick:function(t,e,i,a){var l=this;this.rightClickMenuData=e,this.objectID!==e.id?(this.objectID=e.id,this.menuVisible=!0,this.DATA=e,this.NODE=i):this.menuVisible=!this.menuVisible,document.addEventListener("click",function(t){l.menuVisible=!1});var n=document.querySelector("#rightClickMenu");n.style.left=t.clientX-200+"px",n.style.top=t.clientY-110+"px",n.style.position="absolute",n.style.width="160px"},submitUpload:function(){this.$refs.upload.submit()},handleRemove:function(t,e){console.log(t,e)},handlePreview:function(t){console.log(t)},updateDirectoryInfo:function(){var t,e,i,l,n,s=this;(t=this.tagIcon,e=this.tagName,i=this.tagType,this.rightClickMenuData.id,l=this.$store.getters.userid,n=this.rightClickMenuData.id,Object(a.a)({method:"put",url:"/api/admin/directory/"+n,data:{icon:t,name:e,type:i,typeId:l,id:n}})).then(function(){s.dialogFormVisible=!1,s.getAllDirectory(),s.$notify({title:"成功",message:"更新成功！",type:"success",duration:2e3})})},getAllDirectory:function(){var t=this;Object(a.a)({method:"get",url:"/api/admin/directory/tree",data:{}}).then(function(e){t.allDirectoryList=e.data})},queryTheCurrentNode:function(){var t,e=this;(t=this.rightClickMenuData.id,Object(a.a)({method:"get",url:"/api/admin/directory/"+t,data:{}})).then(function(t){e.tagName=t.data.name,e.tagIcon=t.data.icon,e.tagType=t.data.type})},deleteTheCurrentNode:function(){var t=this;this.$confirm("此操作将永久删除该目录和其子目录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e;(e=t.rightClickMenuData.id,Object(a.a)({method:"delete",url:"/api/admin/directory/"+e,data:{}})).then(function(){t.getAllDirectory(),t.$notify({title:"成功",message:"删除成功！",type:"success",duration:2e3})})})},increasePeerNodes:function(t){var e=this;l(this.tagIcon,this.tagName,this.tagType,this.rightClickMenuData.parentId,this.$store.getters.userid).then(function(){e.dialogFormVisible=!1,e.getAllDirectory(),e.$notify({title:"成功",message:"新增成功！",type:"success",duration:2e3})})},addingChildNodes:function(t){var e=this;l(this.tagIcon,this.tagName,this.tagType,this.rightClickMenuData.id,this.$store.getters.userid).then(function(){e.dialogFormVisible=!1,e.getAllDirectory(),e.$notify({title:"成功",message:"新增成功！",type:"success",duration:2e3})})}}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mainContainer"},[i("el-container",{staticClass:"mainWrap"},[i("el-aside",{staticClass:"nav-left",attrs:{width:"183px"}},[i("el-tree",{ref:"viewTree",attrs:{data:t.allDirectoryList,props:t.defaultProps,"default-expand-all":"","highlight-current":"","node-key":"id"},on:{"node-click":t.testClik,"node-contextmenu":t.rihgtClick},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.node;return e.data,i("span",{staticClass:"custom-tree-node"},[i("span",[a.icon?i("i",{class:a.icon}):t._e(),t._v(" "),a.icon?t._e():i("i",{staticClass:"el-icon-date"}),t._v("\n            "+t._s(a.label)+"\n          ")])])}}])})],1),t._v(" "),i("el-main",[i("el-scrollbar",{staticClass:"scroll-container"},[i("div",{staticClass:"scroll-container-wrap",style:{"padding-right":t.rightPadding+"px"}},[i("transition",{attrs:{mode:"out-in",name:"fade-transform"}},[t.fileListId?i("el-upload",{ref:"upload",staticClass:"upload-demo",staticStyle:{width:"260px",float:"left"},attrs:{"auto-upload":!1,"file-list":t.fileList,"http-request":t.beforeUpload,action:""}},[i("el-button",{attrs:{slot:"trigger",type:"primary"},slot:"trigger"},[t._v("选取文件")]),t._v(" "),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"success"},on:{click:t.submitUpload}},[t._v("上传到服务器")]),t._v(" "),i("br"),t._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"})],1):t._e()],1),t._v(" "),t.fileListId?i("el-input",{staticStyle:{width:"240px",float:"left","margin-right":"20px"},attrs:{placeholder:"请输入内容"},model:{value:t.searchList,callback:function(e){t.searchList=e},expression:"searchList"}}):t._e(),t._v(" "),t.fileListId?i("el-button",{attrs:{type:"primary"},on:{click:t.searchData}},[t._v("搜 索")]):t._e(),t._v(" "),i("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.categoryFileList,"tooltip-effect":"dark"}},[i("el-table-column",{attrs:{type:"selection"}}),t._v(" "),i("el-table-column",{attrs:{label:"名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.fileName))]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"文件大小"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.calculateFileSize(e.row.fileSize)))]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"文件类型",prop:"fileType"}}),t._v(" "),i("el-table-column",{attrs:{label:"创造时间",prop:"crtTime","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{label:"最新操作人",prop:"crtName","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{label:"最新操作时间",prop:"updTime","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){t.deleteList(e.row.id)}}},[t._v("删 除")])]}}])})],1)],1)])],1)],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.menuVisible,expression:"menuVisible"}]},[i("el-menu",{staticClass:"el-menu-vertical",attrs:{"active-text-color":"#fff",id:"rightClickMenu","text-color":"#fff"},on:{select:t.handleRightSelect}},[i("el-menu-item",{staticClass:"menuItem",attrs:{index:"1"}},[i("span",{attrs:{slot:"title"},slot:"title"},[t._v("添加同级")])]),t._v(" "),i("el-menu-item",{staticClass:"menuItem",attrs:{index:"2"}},[i("span",{attrs:{slot:"title"},slot:"title"},[t._v("添加子级")])]),t._v(" "),i("el-menu-item",{staticClass:"menuItem",attrs:{index:"3"}},[i("span",{attrs:{slot:"title"},slot:"title"},[t._v("修改分类")])]),t._v(" "),i("el-menu-item",{staticClass:"menuItem",attrs:{index:"4"}},[i("span",{attrs:{slot:"title"},slot:"title"},[t._v("删除分类")])])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:t.textTitlt,visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{attrs:{"label-width":"80px"}},[i("el-form-item",{attrs:{label:"标签名称"}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:t.tagName,callback:function(e){t.tagName=e},expression:"tagName"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"标签图标"}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:t.tagIcon,callback:function(e){t.tagIcon=e},expression:"tagIcon"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"标签类型"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.tagType,callback:function(e){t.tagType=e},expression:"tagType"}},t._l(t.options,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),1==t.selectKey?i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.increasePeerNodes()}}},[t._v("确 定")]):t._e(),t._v(" "),2==t.selectKey?i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.addingChildNodes()}}},[t._v("确 定")]):t._e(),t._v(" "),3==t.selectKey?i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.updateDirectoryInfo()}}},[t._v("更 新")]):t._e()],1)],1)],1)},staticRenderFns:[]};var r=i("C7Lr")(s,o,!1,function(t){i("QbNV")},"data-v-f79f4fe6",null);e.default=r.exports},QbNV:function(t,e){}});
//# sourceMappingURL=10.9507b5a1241f4dd59e3a.js.map