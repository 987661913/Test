webpackJsonp([15],{"Lf+4":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("4YfN"),r=n.n(i),a=n("NbBB"),o=n("oCum"),l=n("kY/X"),s=n("9rMa"),u={name:"Menu",props:{groupId:{type:String,default:"1"},title:{type:String,default:""},value:{type:Boolean,default:function(){return!1}}},data:function(){return{filterText:"",visible:!1,list:null,total:null,listQuery:{name:void 0},treeData:[],defaultProps:{children:"children",label:"title"},authority_btn_ok:!1,authority_checkbox1:!1,authority_checkbox2:!1,tableHeight:200}},computed:r()({},Object(s.b)(["elements"])),watch:{filterText:function(t){this.$refs.menuTree.filter(t)},value:function(t){this.visible=t,t&&this.getList()},visible:function(t){t||this.$emit("closeAuthorityDialog",t)}},created:function(){this.authority_btn_ok=this.elements.authority_btn_ok,this.authority_checkbox1=this.elements.authority_checkbox1,this.authority_checkbox2=this.elements.authority_checkbox2},mounted:function(){this.value&&(this.visible=!0),window.addEventListener("resize",this.justContainer)},destroyed:function(){window.removeEventListener("resize",this.justContainer)},methods:{selectedable:function(t,e){return this.authority_checkbox1&&this.authority_checkbox2},dialogOpened:function(){this.justContainer()},dialogClose:function(){this.value=!1},getList:function(){var t=this;Object(a.c)(this.listQuery).then(function(e){t.sortByOrder(e.data),t.treeData=e.data,t.initAuthoritys()})},sortByOrder:function(t){if(t&&Array.isArray(t))for(var e in t.sort(function(t,e){return t.orderNum-e.orderNum}),t)t[e].children&&Array.isArray(t[e].children)&&t[e].children.length>0&&this.sortByOrder(t[e].children)},justContainer:function(){document.querySelector(".table-container")&&(this.tableHeight=document.querySelector(".table-container").clientHeight)},filterNode:function(t,e){return!t||-1!==e.label.indexOf(t)},getNodeData:function(t){var e=this;Object(o.e)(t.id).then(function(t){e.sortByCode(t.data),e.list=t.data,Object(l.g)(e.groupId).then(function(t){for(var n={},i=0;i<e.list.length;i++)n[e.list[i].id]=e.list[i];for(var r={},a=0;a<t.data.length;a++){var o=t.data[a];void 0!==n[o]&&void 0===r[o]&&(e.$refs.elementTable.toggleRowSelection(n[t.data[a]]),r[o]=!0)}})}),this.currentId=t.id,this.showElement=!0},sortByCode:function(t){t&&Array.isArray(t)&&t.sort(function(t,e){return t.code===e.code?0:t.code<e.code?-1:1})},getTreeNodeKey:function(t){return t.id},handleSelectionChange:function(t,e){for(var n=!0,i=0;i<t.length;i++)if(t[i].id===e.id){Object(l.a)(this.groupId,{menuId:this.currentId,elementId:e.id}),n=!1;break}n&&Object(l.n)(this.groupId,{menuId:this.currentId,elementId:e.id})},update:function(){var t=this;this.$emit("closeAuthorityDialog");for(var e=this.$refs.menuTree.getCheckedNodes(),n=[],i=0;i<e.length;i++)n.push(e[i].id);Object(l.m)(this.groupId,{menuTrees:n.join()}).then(function(){t.$notify({title:"成功",message:"保存成功",type:"success",duration:2e3})})},initAuthoritys:function(){var t=this;Object(l.h)(this.groupId).then(function(e){for(var n=[],i=0;i<e.data.length;i++)n.push(e.data[i].id);t.$refs.menuTree.setCheckedKeys(n)})}}},c={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{staticClass:"dialog-container",attrs:{title:t.title,visible:t.visible},on:{"update:visible":function(e){t.visible=e},closed:t.dialogClose,opened:t.dialogOpened}},[n("div",{staticClass:"container"},[n("el-container",[n("el-aside",{attrs:{width:"200px"}},[n("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}}),t._v(" "),n("div",{staticClass:"tree-container"},[n("div",{staticClass:"scroll-tree-container"},[n("el-scrollbar",{staticClass:"scroll-container"},[n("el-tree",{ref:"menuTree",staticClass:"filter-tree",attrs:{data:t.treeData,"filter-node-method":t.filterNode,props:t.defaultProps,"check-strictly":"","default-expand-all":"","highlight-current":"","node-key":"id","show-checkbox":""},on:{"node-click":t.getNodeData}})],1)],1)])],1),t._v(" "),n("el-main",[n("div",{staticClass:"table-container"},[n("el-table",{ref:"elementTable",staticStyle:{width:"100%",height:"100%"},attrs:{data:t.list,height:t.tableHeight,border:"",fit:"","highlight-current-row":""},on:{select:t.handleSelectionChange}},[n("el-table-column",{attrs:{selectable:t.selectedable,type:"selection",width:"35"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"资源名称","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.name))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"left","header-align":"center",label:"资源编码",width:"180px"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.code))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"资源类型","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.type))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"资源地址","min-width":"160px"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.uri))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"请求类型",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.method))])]}}])})],1)],1)])],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t.authority_btn_ok?n("el-button",{attrs:{type:"primary"},on:{click:t.update}},[t._v("保存")]):t._e()],1)])},staticRenderFns:[]};var d=n("C7Lr")(u,c,!1,function(t){n("kdhG")},"data-v-276aad3e",null);e.default=d.exports},NbBB:function(t,e,n){"use strict";e.c=function(t){return Object(i.a)({url:"/api/admin/menu/tree",method:"get",params:t})},e.a=function(t){return Object(i.a)({url:"/api/admin/menu",method:"post",data:t})},e.b=function(t){return Object(i.a)({url:"/api/admin/menu/"+t,method:"delete"})},e.d=function(t,e){return Object(i.a)({url:"/api/admin/menu/"+t,method:"put",data:e})};var i=n("vLgD")},kdhG:function(t,e){},oCum:function(t,e,n){"use strict";e.d=function(t){return Object(i.a)({url:"/api/admin/element/page",method:"get",params:t})},e.e=function(t,e){return Object(i.a)({url:"/api/admin/element/list",method:"get",params:{menuId:t,name:e}})},e.a=function(t){return Object(i.a)({url:"/api/admin/element",method:"post",data:t})},e.c=function(t){return Object(i.a)({url:"/api/admin/element/"+t,method:"get"})},e.b=function(t){return Object(i.a)({url:"/api/admin/element/"+t,method:"delete"})},e.f=function(t,e){return Object(i.a)({url:"/api/admin/element/"+t,method:"put",data:e})};var i=n("vLgD")}});
//# sourceMappingURL=15.8e1a6325b082533f4648.js.map